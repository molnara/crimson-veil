CRIMSON VEIL - CHANGELOG
=========================

This file tracks all changes made to the project.
Format: [YYYY-MM-DD HH:MM] - Brief description of change
Encoding: UTF-8 (arrows â†’, checkmarks âœ…, emojis ðŸŽ¯)

META - Workflow Documentation Updates (2025-12-12 22:00):
----------------------------------------------------------
[2025-12-12 22:00] [MAJOR] Created SESSION_START_UPLOAD.md (333 lines) - Upload-based workflow version
[2025-12-12 22:00] [MAJOR] Created QUICK_START.md (200 lines) - Minimal context for fast sessions
[2025-12-12 22:00] [WORKFLOW] Eliminated Claude Project dependency - upload-based sessions prevent UTF-8 corruption
[2025-12-12 22:00] [WORKFLOW] New session starter files in _session_starters/ folder
[2025-12-12 22:00] [WORKFLOW] Session complexity tiers: QUICK_START (bug fixes) â†’ SESSION_START_UPLOAD (features) â†’ Full context (planning)
[2025-12-12 22:00] [DOC] Updated DEVELOPMENT_GUIDE.md - Session Start Checklist now reflects upload-based workflow
[2025-12-12 22:00] [DOC] Updated DEVELOPMENT_GUIDE.md - Session Efficiency Tips for upload workflow
[2025-12-12 22:00] [BENEFIT] No more encoding corruption in Project files
[2025-12-12 22:00] [BENEFIT] Explicit control over context - user chooses what to upload
[2025-12-12 22:00] [BENEFIT] Better token efficiency - upload only what's needed
[2025-12-12 22:00] [FEATURE] Context file selection guide for different task types

META - Session Management System (2025-12-12 20:45):
-----------------------------------------------------
[2025-12-12 20:45] [CRITICAL] Updated SESSION_START.md (332 lines) - COMPLETE FILES ONLY rules now at top
[2025-12-12 20:45] [CRITICAL] Updated FILE_INDEX.md (588 lines) - COMPLETE FILES ONLY rules prominently placed
[2025-12-12 20:45] [DOC] Added mandatory file output checklist - verify every file before output
[2025-12-12 20:45] [DOC] Added step-by-step commit process with complete file requirements
[2025-12-12 20:45] [DOC] Expanded UTF-8 encoding examples with more characters
[2025-12-12 20:45] [WORKFLOW] Emphasized: No partial updates, no diffs, no "add this to line X"
[2025-12-12 20:45] [WORKFLOW] Emphasized: Only two valid outputs - complete file or request upload
[2025-12-12 20:45] [FEATURE] Added verification checklist for every file output
[2025-12-12 20:30] [META] Session management system created - SESSION_START.md and FILE_INDEX.md
[2025-12-12 20:30] [MAJOR] Created SESSION_START.md (234 lines) - Essential session context with file output rules
[2025-12-12 20:30] [MAJOR] Created FILE_INDEX.md (457 lines) - Complete project file map with encoding standards
[2025-12-12 20:30] [OPTIMIZATION] Reduced session startup from 26K to 11K tokens (~58% savings)
[2025-12-12 20:30] [WORKFLOW] New 4-file system: SESSION_START, FILE_INDEX, ROADMAP, CHANGELOG in Claude Project
[2025-12-12 20:30] [WORKFLOW] DEVELOPMENT_GUIDE.md moved to docs/ in git repo (requested when architecture context needed)
[2025-12-12 20:30] [DOC] Updated DEVELOPMENT_GUIDE.md - Session Start Checklist now references new file system
[2025-12-12 20:30] [DOC] Updated DEVELOPMENT_GUIDE.md - Session Efficiency Tips updated for FILE_INDEX workflow
[2025-12-12 20:30] [FEATURE] File output rules established - always output COMPLETE files with EXACT names
[2025-12-12 20:30] [FEATURE] UTF-8 encoding standard - proper arrows (â†’), checkmarks (âœ…), emojis (ðŸŽ¯)
[2025-12-12 20:30] [FEATURE] Clear file request pattern established: "I need to see: [file path]"
[2025-12-12 20:30] [BENEFIT] Token usage now scales with task complexity (11K base + files needed)
[2025-12-12 20:30] [BENEFIT] Averages 15-20K token savings per session across typical workflows
[2025-12-12 20:30] [BENEFIT] No more partial updates or temporary filename suffixes (_CLEAN, _NEW, etc.)

Recent Changes (v0.5.0+):
-------------------------
[2025-12-12 22:45] [MAJOR] Task 2.5 complete - Container sound integration (chest_open, chest_close)
[2025-12-12 22:45] [FEATURE] Chest open sound plays when container opened - satisfying audio feedback
[2025-12-12 22:45] [FEATURE] Chest close sound plays when container closed - completion cue
[2025-12-12 22:45] [MINOR] Updated storage_container.gd - Added AudioManager calls to open() and close() functions
[2025-12-12 22:45] [MAJOR] Task 2.4 complete - Building sound integration (block_place, block_remove, build_toggle)
[2025-12-12 22:45] [FEATURE] Block placement sound plays when placing blocks or chests - punchy placement feedback
[2025-12-12 22:45] [FEATURE] Block removal sound plays when removing blocks or chests - satisfying destruction audio
[2025-12-12 22:45] [FEATURE] Build mode toggle sound plays when entering/exiting build mode - clear UI state change
[2025-12-12 22:45] [MINOR] Updated building_system.gd - Added AudioManager calls to place_block(), remove_block_at_position(), enable/disable_building_mode()
[2025-12-12 22:45] [FIX] Chest collision layer fix - Chests now on BOTH Layer 1 (physical blocking) AND Layer 3 (interaction)
[2025-12-12 22:45] [FIX] Chests can now be opened - Player interaction raycast on Layer 3 now detects properly
[2025-12-12 22:45] [FIX] Chests can now be removed - Building removal raycast on Layer 1 now detects properly
[2025-12-12 22:45] [FIX] Chests now block player movement - Physical collision on Layer 1 prevents walking through
[2025-12-12 22:45] [MINOR] Updated storage_container.gd - Changed collision_layer from 4 (Layer 3 only) to 5 (Layers 1 + 3)
[2025-12-12 18:45] [POLISH] Reduced ambient sound volumes by ~30% for more subtle atmosphere
[2025-12-12 18:45] [MINOR] Updated VOLUME_ADJUSTMENTS in ambient_manager.gd (wind, birds, crickets quieter)
[2025-12-12 18:30] [MAJOR] Task 2.3 complete - Ambient Environmental Sound System implemented
[2025-12-12 18:30] [FEATURE] Biome-aware ambient loops with 6 biome configurations (Grassland, Forest, Beach, Mountain, Desert, Snow)
[2025-12-12 18:30] [FEATURE] Occasional/rare frequency system prevents audio spam (20%-60% play chance)
[2025-12-12 18:30] [FEATURE] Time-based ambient layers (birds day, crickets/frogs night)
[2025-12-12 18:30] [FEATURE] Smart timer system - 15-30s play duration, 45-90s silence between
[2025-12-12 18:30] [FEATURE] Custom volume per sound type for perfect balance
[2025-12-12 18:30] [FEATURE] Smooth biome transitions with 2-second fade-outs
[2025-12-12 18:30] [FEATURE] 10-second startup delay after game launch
[2025-12-12 18:30] [FEATURE] Dynamic biome detection every 2 seconds
[2025-12-12 18:30] [MINOR] Created ambient_manager.gd AutoLoad (~400 lines)
[2025-12-12 18:30] [DOC] Created AMBIENT_MANAGER_README.md comprehensive documentation
[2025-12-12 18:00] [MAJOR] Task 2.2 complete - Music Manager & AI Music System implemented
[2025-12-12 18:00] [FEATURE] Day/night music rotation with 4 tracks each (8 total)
[2025-12-12 18:00] [FEATURE] Smart track variety system - prevents repetition, never plays same twice in a row
[2025-12-12 18:00] [FEATURE] Smooth 1-hour crossfade transitions at dawn/dusk (5:30-6:30 AM/PM)
[2025-12-12 18:00] [FEATURE] 30-second crossfade duration for seamless transitions
[2025-12-12 18:00] [FEATURE] 8-second startup delay for calm intro before music
[2025-12-12 18:00] [FEATURE] Autonomous operation - monitors day/night cycle automatically
[2025-12-12 18:00] [FEATURE] History-based rotation - tracks last 2 played tracks
[2025-12-12 18:00] [MINOR] Created music_manager.gd AutoLoad (~250 lines)
[2025-12-12 18:00] [DOC] Created MUSIC_MANAGER_README.md comprehensive documentation
[2025-12-12 09:15] [FIX] Removed log despawn sound - eliminated resource_break audio spam when multiple logs disappear
[2025-12-12 09:15] [POLISH] Log despawn now silent - particle effects remain, audio removed for better balance
[2025-12-12 09:15] [MINOR] Updated log_piece.gd - removed AudioManager.play_sound() call from despawn() function
[2025-12-12 04:45] [MAJOR] Task 2.1 complete - Movement sounds (footsteps) fully implemented
[2025-12-12 04:45] [FEATURE] Biome-aware footstep system with 4 surface types (grass, stone, sand, snow)
[2025-12-12 04:45] [FEATURE] Footstep timing: 0.45s walk interval, 0.28s sprint interval
[2025-12-12 04:45] [FEATURE] 12 footstep audio variants (3 per surface) with automatic pitch variation
[2025-12-12 04:45] [FEATURE] Dual ground detection: floor check + velocity-based steep slope support
[2025-12-12 04:45] [FEATURE] Works on slopes up to 80Â° (beyond floor_max_angle limit)
[2025-12-12 04:45] [FEATURE] Smooth biome transitions with 3% buffer zones (2-4 meter transition)
[2025-12-12 04:45] [FIX] Beach spawn zone override removed - footsteps now match visual biome
[2025-12-12 04:45] [FIX] Steep slope detection using velocity thresholds (y < 3.5, length > 0.3)
[2025-12-12 04:45] [FIX] Biome transition buffer tuned for natural feel in both directions
[2025-12-12 04:45] [MINOR] Added footstep timer variables (walk/sprint intervals)
[2025-12-12 04:45] [MINOR] Added _get_terrain_surface() method with noise-based biome detection
[2025-12-12 04:45] [MINOR] Integrated footstep logic in _physics_process() after move_and_slide()
[2025-12-12 04:45] [MINOR] Footsteps respect grounded state, flying mode, and movement direction
[2025-12-12 08:30] [MAJOR] Task 1.3 complete - Harvesting Sound Integration complete
[2025-12-12 08:30] [FEATURE] Harvesting sounds integrated - axe_chop on trees, pickaxe_hit on rocks, mushroom/strawberry pick sounds
[2025-12-12 08:30] [FEATURE] Resource break sound plays on harvest completion for all resource types
[2025-12-12 08:30] [FEATURE] Wrong tool sound provides immediate negative feedback
[2025-12-12 08:30] [FEATURE] Tool switch sound on equipment change (no pitch variation for consistency)
[2025-12-12 08:30] [FEATURE] Log despawn sound - each log piece plays "poof" sound when disappearing after 4 seconds
[2025-12-12 08:30] [MINOR] Updated harvestable_resource.gd - Added AudioManager.play_sound() calls for harvesting
[2025-12-12 08:30] [MINOR] Updated tree.gd - Added resource_break sound on completion
[2025-12-12 08:30] [MINOR] Updated rock.gd - Added resource_break sound on completion
[2025-12-12 08:30] [MINOR] Updated mushroom.gd - Added resource_break sound on completion
[2025-12-12 08:30] [MINOR] Updated strawberry.gd - Added resource_break sound on completion
[2025-12-12 08:30] [MINOR] Updated tool_system.gd - Added tool_switch sound on cycle_tool()
[2025-12-12 08:30] [MINOR] Updated log_piece.gd - Added resource_break sound on despawn
[2025-12-12 01:00] [MAJOR] Task 1.2 complete - AI Sound Generation & Import (48 audio files)
[2025-12-12 01:00] [FEATURE] 48 audio files generated using SFX Engine ($8) + Mubert ($14) = $22 total
[2025-12-12 01:00] [FEATURE] 6 harvesting sounds (axe, pickaxe, mushroom, strawberry, resource_break, wrong_tool)
[2025-12-12 01:00] [FEATURE] 12 footstep sounds (4 surfaces Ã— 3 variants each)
[2025-12-12 01:00] [FEATURE] 3 building sounds (block_place, block_remove, build_mode_toggle)
[2025-12-12 01:00] [FEATURE] 9 UI sounds (inventory, crafting, stack_full, tool_switch, health/hunger warnings, setting_click)
[2025-12-12 01:00] [FEATURE] 2 container sounds (chest_open, chest_close)
[2025-12-12 01:00] [FEATURE] 8 ambient loops (wind light/strong, ocean, crickets, birds, frogs, leaves, thunder)
[2025-12-12 01:00] [FEATURE] 8 music tracks (4 day ambient + 4 night ambient, 2 min each)
[2025-12-12 01:00] [MINOR] Imported all 48 files to res://audio/ with proper folder structure
[2025-12-12 01:00] [MINOR] Updated audio_manager.gd - Added all 48 sounds to preload library
[2025-12-12 01:00] [MINOR] Verified audio files play correctly in Godot
[2025-12-11 19:11] [MAJOR] Task 1.1 complete - Audio Manager Architecture implemented
[2025-12-11 19:11] [FEATURE] Sound pooling system - max 10 concurrent sounds to prevent audio spam
[2025-12-11 19:11] [FEATURE] Volume categories - Master, SFX, Music, Ambient, UI with hybrid philosophy
[2025-12-11 19:11] [FEATURE] Pitch variation system - random 0.9-1.1x for natural sound feel
[2025-12-11 19:11] [FEATURE] Music crossfade system - smooth transitions using Tween
[2025-12-11 19:11] [FEATURE] Ambient loop management - multiple concurrent environmental sounds
[2025-12-11 19:11] [FEATURE] Complete playback API - play_sound(), play_music(), play_sound_variant()
[2025-12-11 19:11] [MINOR] Created audio_manager_test.gd - comprehensive test suite
[2025-12-11 19:11] [MINOR] Created audio_manager_test.tscn - test scene for verification
[2025-12-11 19:11] [MINOR] Updated project.godot - added AudioManager to autoload
[2025-12-11 19:11] [DOC] Created AUDIO_MANAGER_README.md - complete implementation documentation
[2025-12-11 19:11] [DOC] Updated DEVELOPMENT_GUIDE.md - added .uid file guidance and commit best practices
[2025-12-11 19:11] [DOC] Updated DEVELOPMENT_GUIDE.md - added Audio Systems section to File Index
[2025-12-11 19:11] [DOC] Updated DEVELOPMENT_GUIDE.md - moved Audio Manager to Currently Implemented
[2025-12-11 19:11] [TEST] All tests passing - singleton, volume levels, sound pool, music player verified
[2025-12-11 16:30] [PLANNING] v0.5.0 "Atmosphere & Audio" sprint planned - pivot from workbench to sound/music
[2025-12-11 16:30] [PLANNING] Sprint scope: Audio manager, 43 AI-generated sounds, music system ($34 budget)
[2025-12-11 16:30] [PLANNING] Design decisions: Pure ambient drone music, biome-aware footsteps, hybrid volume
[2025-12-11 16:30] [PLANNING] Timeline: 12-15 sessions over 7-10 days using Sonnet
[2025-12-11 16:30] [DOC] Updated ROADMAP.txt - Added v0.5.0 "Atmosphere & Audio" sprint
[2025-12-11 16:30] [DOC] Updated ROADMAP.txt - Moved workbench/inventory features to "Next Up" section
[2025-12-11 11:30] [CODE_REVIEW] Opus 4.5 comprehensive code review complete
[2025-12-11 11:30] [REVIEW] Overall grade: A (Excellent) - Strong architecture, clean patterns, good documentation
[2025-12-11 11:30] [REVIEW] Strengths: Modular design, signal-based communication, consistent naming
[2025-12-11 11:30] [REVIEW] Recommendations: Extract critter visuals, consolidate ITEM_COLORS, add container null checks
[2025-12-11 11:30] [DOC] Created CODE_REVIEW.md (500 lines) - Comprehensive codebase analysis
[2025-12-11 11:30] [DOC] Updated ROADMAP.txt - Added technical debt items from code review

v0.4.0 RELEASE (December 12, 2025) - "Storage & Organization":
--------------------------------------------------------------
Sprint Completion: 11/15 tasks (73%) - Priorities 1 & 2 fully complete
Commit: d53049d

[2025-12-12 04:00] [RELEASE] v0.4.0 tagged and released - Storage Containers & Item Stacking
[2025-12-12 03:45] [MAJOR] Container UI complete - dual-panel interface with click/shift-click transfers (Phase 2)
[2025-12-12 03:45] [FEATURE] Container UI - Click to transfer single item between panels
[2025-12-12 03:45] [FEATURE] Container UI - Shift+click to transfer entire stack
[2025-12-12 03:45] [FEATURE] Container UI - 32 slots per side with scroll if needed
[2025-12-12 03:45] [FEATURE] Container UI - Real-time stack count updates
[2025-12-12 03:45] [FEATURE] Container UI - Context-aware button text (Take/Store)
[2025-12-12 03:45] [FEATURE] UI state suppression - Inventory/crafting hidden when container open
[2025-12-12 03:45] [FEATURE] UI state restoration - Previous UI state returns when container closes
[2025-12-12 03:45] [FEATURE] B button closes container (Xbox controller)
[2025-12-12 03:45] [FEATURE] Container distance check - Auto-closes if player moves >3m away
[2025-12-12 03:45] [MINOR] Created container_ui.tscn - Scene-based UI for easier visual editing
[2025-12-12 03:45] [MINOR] Updated player.gd - Added input suppression system for container interaction
[2025-12-12 03:45] [MINOR] Updated game_ui.gd - Added container UI coordination
[2025-12-12 03:45] [FIX] Container panels centered properly in viewport
[2025-12-12 03:45] [FIX] Container panels in correct order (player left, container right)
[2025-12-12 03:45] [FIX] Other UIs properly hidden when container open
[2025-12-12 03:45] [FIX] Inventory debug text removed during container interaction
[2025-12-11 20:00] [MAJOR] Container system complete - placement, interaction, highlighting, removal (Phase 1)
[2025-12-11 20:00] [FEATURE] Container placement - Build menu category "Containers"
[2025-12-11 20:00] [FEATURE] Container crafting - Costs 10 wood to craft
[2025-12-11 20:00] [FEATURE] Container interaction - E key or A button opens chest within 3m
[2025-12-11 20:00] [FEATURE] Container highlighting - Green outline when looking at chest
[2025-12-11 20:00] [FEATURE] Container removal - Harvesting system integration
[2025-12-11 20:00] [FEATURE] Container removal warning - Dialog if chest contains items
[2025-12-11 20:00] [FEATURE] Independent inventories - Each chest has own 32-slot Inventory instance
[2025-12-11 20:00] [FEATURE] Low-poly chest visual - Procedural mesh with 16x16 wood/metal texture
[2025-12-11 20:00] [FEATURE] Context-aware A button - Opens chest (not inventory) when looking at container
[2025-12-11 20:00] [MINOR] Created storage_container.gd (120 lines)
[2025-12-11 20:00] [MINOR] Updated building_system.gd - Added container to buildable blocks
[2025-12-11 20:00] [MINOR] Updated harvesting_system.gd - Added container support to resource detection
[2025-12-11 20:00] [MINOR] Updated player.gd - Added context-aware A button logic
[2025-12-11 20:00] [MINOR] Updated block_data.gd - Added CONTAINER block type
[2025-12-11 20:00] [FIX] Collision layer 3 used for chest highlighting (separate from resources)
[2025-12-11 16:00] [MAJOR] D-Pad input conflict resolved - building controls working perfectly
[2025-12-11 16:00] [FEATURE] D-Pad dedicated to building - Up: place, Down: remove, Left/Right: rotate
[2025-12-11 16:00] [FEATURE] Left stick for movement only - No D-Pad movement conflicts
[2025-12-11 16:00] [FIX] Removed D-Pad from movement input actions in project.godot
[2025-12-11 16:00] [FIX] Updated player.gd - Removed D-Pad movement code
[2025-12-11 16:00] [MINOR] Updated building_system.gd - Verified D-Pad building controls working
[2025-12-11 14:30] [MAJOR] Item stacking system complete - all items stack with proper limits
[2025-12-11 14:30] [FEATURE] Stack limits enforced - wood: 100, stone: 50, food: 20, tools: 1
[2025-12-11 14:30] [FEATURE] Stack splitting - Right-click splits stack in half
[2025-12-11 14:30] [FEATURE] Stack combining - Drag-and-drop combines partial stacks
[2025-12-11 14:30] [FEATURE] Visual stack counts - Number displayed on each inventory slot
[2025-12-11 14:30] [FEATURE] Overflow handling - New slots created when stack full
[2025-12-12-12 14:30] [FEATURE] Crafting integration - Consumes from stacks correctly
[2025-12-11 14:30] [MINOR] Updated inventory.gd - Added stacking logic (max 99 items per stack)
[2025-12-11 14:30] [MINOR] Updated inventory_ui.gd - Stack count labels added
[2025-12-11 14:30] [MINOR] Updated item_data.gd - Added max_stack_size property
[2025-12-11 14:30] [FIX] Tool switching maintains stack counts correctly

v0.3.0 (December 10, 2025) - "Crafting & Building":
---------------------------------------------------
[2025-12-10 22:00] [RELEASE] v0.3.0 tagged - Crafting and building systems complete
[2025-12-10 21:45] [MAJOR] Building system complete - place/remove blocks with preview
[2025-12-10 20:30] [MAJOR] Crafting system complete - recipes, UI, resource consumption
[2025-12-10 19:15] [FEATURE] Tree visual extraction - Extracted to tree_visual.gd
[2025-12-10 18:00] [FEATURE] Minimal tool system - Axe/pickaxe with requirement checking

---
End of Changelog
